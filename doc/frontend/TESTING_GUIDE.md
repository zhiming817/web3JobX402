# å‰ç«¯ API é›†æˆå¿«é€Ÿæµ‹è¯•æŒ‡å—

## å‰ç½®æ¡ä»¶

1. **åç«¯æœåŠ¡è¿è¡Œä¸­**
   ```bash
   cd backend
   cargo run
   # åº”è¯¥åœ¨ http://127.0.0.1:4021 è¿è¡Œ
   ```

2. **å‰ç«¯æœåŠ¡è¿è¡Œä¸­**
   ```bash
   cd frontend/web
   pnpm install
   pnpm dev
   # åº”è¯¥åœ¨ http://localhost:5173 è¿è¡Œ
   ```

3. **é’±åŒ…å‡†å¤‡**
   - å®‰è£… Phantom æˆ–å…¶ä»– Solana é’±åŒ…æ‰©å±•
   - ç¡®ä¿é’±åŒ…æœ‰æµ‹è¯•ç½‘ SOL (ç”¨äº x402 æ”¯ä»˜æµ‹è¯•)

## æµ‹è¯•åœºæ™¯

### âœ… åœºæ™¯ 1: åˆ›å»ºç®€å†

**æ­¥éª¤:**
1. è®¿é—® http://localhost:5173
2. ç‚¹å‡»"è¿æ¥é’±åŒ…"æŒ‰é’®
3. åœ¨ Phantom ä¸­æ‰¹å‡†è¿æ¥
4. ç‚¹å‡»"åˆ›å»ºç®€å†"æˆ–è®¿é—® `/resume/create`
5. å¡«å†™è¡¨å• (è‡³å°‘å¡«å†™å¿…å¡«é¡¹):
   - å§“å: å¼ ä¸‰
   - æ€§åˆ«: ç”·
   - æ‰‹æœº: 13800138000
   - æœŸæœ›èŒä½: å‰ç«¯å·¥ç¨‹å¸ˆ
   - è–ªèµ„èŒƒå›´: 15000 - 25000
6. ç‚¹å‡»"åˆ›å»ºç®€å†"æŒ‰é’®

**é¢„æœŸç»“æœ:**
- âœ… æ˜¾ç¤º"åˆ›å»ºä¸­..."åŠ è½½çŠ¶æ€
- âœ… åç«¯æ§åˆ¶å°è¾“å‡ºåˆ›å»ºç®€å†çš„æ—¥å¿—
- âœ… æˆåŠŸåè·³è½¬åˆ°"æˆ‘çš„ç®€å†"é¡µé¢
- âœ… æ–°åˆ›å»ºçš„ç®€å†å‡ºç°åœ¨åˆ—è¡¨ä¸­

**æ£€æŸ¥ç‚¹:**
```bash
# åç«¯æ—¥å¿—åº”è¯¥æ˜¾ç¤º:
POST /api/users/register  # è‡ªåŠ¨æ³¨å†Œç”¨æˆ·
POST /api/resumes         # åˆ›å»ºç®€å†

# å‰ç«¯æ§åˆ¶å°:
console.log('ç®€å†åˆ›å»ºæˆåŠŸ:', { resumeId: 1 })
```

---

### âœ… åœºæ™¯ 2: æŸ¥çœ‹æˆ‘çš„ç®€å†

**æ­¥éª¤:**
1. ç¡®ä¿å·²åˆ›å»ºè‡³å°‘ 1 ä¸ªç®€å†
2. è®¿é—®"æˆ‘çš„ç®€å†"é¡µé¢æˆ– `/resume/list`
3. è§‚å¯Ÿç®€å†åˆ—è¡¨

**é¢„æœŸç»“æœ:**
- âœ… æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- âœ… åŠ è½½å®Œæˆåæ˜¾ç¤ºç®€å†åˆ—è¡¨
- âœ… æ¯ä¸ªç®€å†æ˜¾ç¤º:
  - å§“å
  - æ›´æ–°æ—¶é—´
  - æµè§ˆé‡
  - è§£é”æ•°
  - æ”¶ç›Š (SOL)
- âœ… ç»Ÿè®¡æ•°æ®æ­£ç¡® (æ€»ç®€å†æ•°ã€æ€»æµè§ˆã€æ€»æ”¶ç›Š)

**æ£€æŸ¥ç‚¹:**
```bash
# åç«¯æ—¥å¿—:
GET /api/resumes/my/{wallet_address}

# å‰ç«¯æ§åˆ¶å°:
console.log('æˆ‘çš„ç®€å†:', [...])
```

---

### âœ… åœºæ™¯ 3: åˆ é™¤ç®€å†

**æ­¥éª¤:**
1. åœ¨"æˆ‘çš„ç®€å†"é¡µé¢
2. ç‚¹å‡»æŸä¸ªç®€å†çš„"åˆ é™¤"æŒ‰é’®
3. ç¡®è®¤åˆ é™¤

**é¢„æœŸç»“æœ:**
- âœ… æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
- âœ… ç¡®è®¤åç®€å†ä»åˆ—è¡¨ä¸­æ¶ˆå¤±
- âœ… ç»Ÿè®¡æ•°æ®æ›´æ–°

**æ£€æŸ¥ç‚¹:**
```bash
# åç«¯æ—¥å¿—:
DELETE /api/resumes/{resume_id}?owner={wallet}

# æ•°æ®åº“æ£€æŸ¥:
SELECT * FROM resumes WHERE resume_id = X;  # åº”è¯¥è¿”å›ç©º
```

---

### âœ… åœºæ™¯ 4: æµè§ˆç®€å†åˆ—è¡¨

**æ­¥éª¤:**
1. è®¿é—®"æµè§ˆç®€å†"é¡µé¢æˆ– `/resume/browse`
2. ç­‰å¾…åŠ è½½å®Œæˆ

**é¢„æœŸç»“æœ:**
- âœ… æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
- âœ… æ˜¾ç¤ºæ‰€æœ‰å…¬å¼€ç®€å†
- âœ… æ¯ä¸ªç®€å†å¡ç‰‡æ˜¾ç¤º:
  - å¤´åƒ (ğŸ‘¨â€ğŸ’» æˆ– ğŸ‘©â€ğŸ’»)
  - å§“å (åŒ¿ååŒ–,å¦‚"å¼ **")
  - èŒä½
  - å·¥ä½œç»éªŒ (å¦‚"3-5å¹´")
  - å­¦å† (å¦‚"æœ¬ç§‘")
  - åœ°ç‚¹
  - è–ªèµ„èŒƒå›´
  - è§£é”ä»·æ ¼
- âœ… æ•°æ®è½¬æ¢æ­£ç¡®

**æ£€æŸ¥ç‚¹:**
```bash
# åç«¯æ—¥å¿—:
GET /api/resumes/summaries

# å‰ç«¯æ§åˆ¶å°:
console.log('ç®€å†åˆ—è¡¨:', [...])

# æ£€æŸ¥æ•°æ®è½¬æ¢:
å·¥ä½œç»éªŒè®¡ç®—: "2020-07-01" -> "3-5å¹´"
è–ªèµ„æ ¼å¼åŒ–: 15000, 25000 -> "15-25K"
å­¦å†æå–: [{ degree: "æœ¬ç§‘" }] -> "æœ¬ç§‘"
```

---

### âœ… åœºæ™¯ 5: ç­›é€‰ç®€å†

**æ­¥éª¤:**
1. åœ¨"æµè§ˆç®€å†"é¡µé¢
2. åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯ (å¦‚"å·¥ç¨‹å¸ˆ")
3. é€‰æ‹©åœ°ç‚¹ (å¦‚"åŒ—äº¬")
4. é€‰æ‹©å·¥ä½œç»éªŒ (å¦‚"3-5å¹´")

**é¢„æœŸç»“æœ:**
- âœ… åˆ—è¡¨å®æ—¶æ›´æ–°,åªæ˜¾ç¤ºåŒ¹é…çš„ç®€å†
- âœ… å¤šä¸ªç­›é€‰æ¡ä»¶åŒæ—¶ç”Ÿæ•ˆ
- âœ… æ¸…ç©ºç­›é€‰åæ¢å¤æ‰€æœ‰ç®€å†

---

### âš ï¸ åœºæ™¯ 6: è§£é”ç®€å† (éœ€è¦ x402 æ”¯ä»˜)

**æ­¥éª¤:**
1. åœ¨"æµè§ˆç®€å†"é¡µé¢
2. ç‚¹å‡»æŸä¸ªç®€å†çš„"è§£é”"æŒ‰é’®
3. ç¡®è®¤æ”¯ä»˜

**é¢„æœŸç»“æœ:**
- âœ… æ˜¾ç¤ºæ”¯ä»˜ç¡®è®¤å¯¹è¯æ¡†,åŒ…å«ä»·æ ¼
- âœ… å¦‚æœæœªè¿æ¥é’±åŒ…,æç¤º"è¯·å…ˆè¿æ¥é’±åŒ…"
- âœ… è°ƒç”¨åç«¯ API
- âš ï¸ å¦‚æœæœªå®ç°çœŸå® x402 æ”¯ä»˜:
  - å¯èƒ½è¿”å›é”™è¯¯ (è¿™æ˜¯æ­£å¸¸çš„)
  - å‰ç«¯åº”æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯ä¿¡æ¯

**æ£€æŸ¥ç‚¹:**
```bash
# åç«¯æ—¥å¿—:
POST /api/resumes/unlock
{
  "resume_id": 1,
  "buyer_wallet": "xxx"
}

# å‰ç«¯æ§åˆ¶å°:
console.log('è§£é”è¯·æ±‚:', { resumeId, buyerWallet })

# å¦‚æœ x402 æœªå®ç°:
console.error('è§£é”å¤±è´¥:', 'x402 payment required')
```

---

## æµ‹è¯•æ•°æ®å‡†å¤‡

### åˆ›å»ºæµ‹è¯•ç®€å† (ä½¿ç”¨ curl)

```bash
# 1. æ³¨å†Œç”¨æˆ·
curl -X POST http://127.0.0.1:4021/api/users/register \
  -H "Content-Type: application/json" \
  -d '{
    "wallet_address": "test_wallet_123",
    "nickname": "æµ‹è¯•ç”¨æˆ·"
  }'

# 2. åˆ›å»ºç®€å† 1
curl -X POST http://127.0.0.1:4021/api/resumes \
  -H "Content-Type: application/json" \
  -d '{
    "owner": "test_wallet_123",
    "personal": {
      "name": "å¼ ä¸‰",
      "gender": "ç”·",
      "birth_date": "1995-01-01",
      "work_start_date": "2018-07-01",
      "job_status": "åœ¨èŒ-è€ƒè™‘æœºä¼š",
      "phone": "13800138000",
      "email": "zhangsan@example.com"
    },
    "desired_position": {
      "position": "å‰ç«¯å·¥ç¨‹å¸ˆ",
      "city": "åŒ—äº¬",
      "salary_min": 15000,
      "salary_max": 25000
    },
    "education": [
      {
        "degree": "æœ¬ç§‘",
        "school": "æ¸…åå¤§å­¦",
        "major": "è®¡ç®—æœºç§‘å­¦",
        "start_date": "2014-09-01",
        "end_date": "2018-06-30"
      }
    ]
  }'

# 3. åˆ›å»ºç®€å† 2
curl -X POST http://127.0.0.1:4021/api/resumes \
  -H "Content-Type: application/json" \
  -d '{
    "owner": "test_wallet_123",
    "personal": {
      "name": "æå››",
      "gender": "å¥³",
      "birth_date": "1992-05-15",
      "work_start_date": "2015-07-01",
      "job_status": "ç¦»èŒ-éšæ—¶åˆ°å²—",
      "phone": "13900139000",
      "email": "lisi@example.com"
    },
    "desired_position": {
      "position": "åç«¯å·¥ç¨‹å¸ˆ",
      "city": "ä¸Šæµ·",
      "salary_min": 20000,
      "salary_max": 30000
    },
    "education": [
      {
        "degree": "ç¡•å£«",
        "school": "åŒ—äº¬å¤§å­¦",
        "major": "è½¯ä»¶å·¥ç¨‹",
        "start_date": "2012-09-01",
        "end_date": "2015-06-30"
      }
    ]
  }'
```

---

## å¸¸è§é—®é¢˜æ’æŸ¥

### 1. API è°ƒç”¨å¤±è´¥

**ç°è±¡:** å‰ç«¯æ˜¾ç¤º"åŠ è½½å¤±è´¥"

**æ£€æŸ¥:**
```bash
# 1. åç«¯æ˜¯å¦è¿è¡Œ
curl http://127.0.0.1:4021/health

# 2. æ£€æŸ¥å‰ç«¯ç¯å¢ƒå˜é‡
cat frontend/web/.env.development
# åº”è¯¥åŒ…å«: VITE_API_BASE_URL=http://127.0.0.1:4021

# 3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°
# Network æ ‡ç­¾æŸ¥çœ‹ API è¯·æ±‚çŠ¶æ€
```

**è§£å†³æ–¹æ¡ˆ:**
- ç¡®ä¿åç«¯åœ¨ 4021 ç«¯å£è¿è¡Œ
- ç¡®ä¿ `.env.development` é…ç½®æ­£ç¡®
- æ£€æŸ¥ CORS è®¾ç½®

---

### 2. æ•°æ®æ ¼å¼é”™è¯¯

**ç°è±¡:** ç®€å†æ˜¾ç¤º"æœªçŸ¥"æˆ–ç©ºç™½

**æ£€æŸ¥:**
```javascript
// æµè§ˆå™¨æ§åˆ¶å°
console.log('åŸå§‹æ•°æ®:', data);
console.log('è½¬æ¢å:', formattedResumes);
```

**è§£å†³æ–¹æ¡ˆ:**
- æ£€æŸ¥ `resume.transform.js` çš„è½¬æ¢é€»è¾‘
- ç¡®ä¿åç«¯è¿”å›çš„ JSON ç»“æ„æ­£ç¡®
- æ£€æŸ¥å¿…å¡«å­—æ®µæ˜¯å¦å­˜åœ¨

---

### 3. é’±åŒ…è¿æ¥å¤±è´¥

**ç°è±¡:** ç‚¹å‡»"è¿æ¥é’±åŒ…"æ— ååº”

**æ£€æŸ¥:**
- æ˜¯å¦å®‰è£…äº†é’±åŒ…æ‰©å±• (Phantom/Solflare)
- æµè§ˆå™¨æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯
- ç½‘ç»œæ˜¯å¦åˆ‡æ¢åˆ°æµ‹è¯•ç½‘

---

### 4. è§£é”åŠŸèƒ½æŠ¥é”™

**ç°è±¡:** ç‚¹å‡»è§£é”åæ˜¾ç¤ºé”™è¯¯

**è¿™æ˜¯æ­£å¸¸çš„!** å› ä¸º:
- x402 æ”¯ä»˜éœ€è¦çœŸå®çš„é“¾ä¸Šäº¤æ˜“
- éœ€è¦é’±åŒ…æœ‰è¶³å¤Ÿçš„ SOL
- åç«¯ä¼šéªŒè¯ x402 æ”¯ä»˜ç­¾å

**ä¸´æ—¶æµ‹è¯•æ–¹æ¡ˆ:**
- æ£€æŸ¥ API æ˜¯å¦æ­£ç¡®è°ƒç”¨
- ç¡®è®¤é”™è¯¯ä¿¡æ¯å‹å¥½
- åç»­é›†æˆçœŸå®çš„ x402 æ”¯ä»˜æµç¨‹

---

## è‡ªåŠ¨åŒ–æµ‹è¯• (å¯é€‰)

### ä½¿ç”¨ curl æµ‹è¯•æ‰€æœ‰ API

```bash
#!/bin/bash
# test_api.sh

BASE_URL="http://127.0.0.1:4021"
WALLET="test_wallet_$(date +%s)"

echo "1. æ³¨å†Œç”¨æˆ·..."
curl -X POST $BASE_URL/api/users/register \
  -H "Content-Type: application/json" \
  -d "{\"wallet_address\": \"$WALLET\", \"nickname\": \"æµ‹è¯•ç”¨æˆ·\"}"

echo -e "\n2. åˆ›å»ºç®€å†..."
RESUME_ID=$(curl -X POST $BASE_URL/api/resumes \
  -H "Content-Type: application/json" \
  -d "{\"owner\": \"$WALLET\", \"personal\": {\"name\": \"æµ‹è¯•\", \"phone\": \"13800138000\"}, \"desired_position\": {\"position\": \"å·¥ç¨‹å¸ˆ\"}}" \
  | jq -r '.resumeId')

echo -e "\n3. è·å–æˆ‘çš„ç®€å†..."
curl "$BASE_URL/api/resumes/my/$WALLET"

echo -e "\n4. è·å–ç®€å†æ‘˜è¦..."
curl "$BASE_URL/api/resumes/summaries"

echo -e "\n5. åˆ é™¤ç®€å†..."
curl -X DELETE "$BASE_URL/api/resumes/$RESUME_ID?owner=$WALLET"

echo -e "\nâœ… æµ‹è¯•å®Œæˆ!"
```

è¿è¡Œæµ‹è¯•:
```bash
chmod +x test_api.sh
./test_api.sh
```

---

**æµ‹è¯•å®Œæˆå,è¯·åœ¨ä¸‹æ–¹è®°å½•æµ‹è¯•ç»“æœ:**

- [ ] åœºæ™¯ 1: åˆ›å»ºç®€å† - âœ… é€šè¿‡ / âŒ å¤±è´¥
- [ ] åœºæ™¯ 2: æŸ¥çœ‹æˆ‘çš„ç®€å† - âœ… é€šè¿‡ / âŒ å¤±è´¥
- [ ] åœºæ™¯ 3: åˆ é™¤ç®€å† - âœ… é€šè¿‡ / âŒ å¤±è´¥
- [ ] åœºæ™¯ 4: æµè§ˆç®€å†åˆ—è¡¨ - âœ… é€šè¿‡ / âŒ å¤±è´¥
- [ ] åœºæ™¯ 5: ç­›é€‰ç®€å† - âœ… é€šè¿‡ / âŒ å¤±è´¥
- [ ] åœºæ™¯ 6: è§£é”ç®€å† - âš ï¸ éœ€è¦ x402 æ”¯ä»˜

**æµ‹è¯•æ—¥æœŸ:** ____________________  
**æµ‹è¯•äººå‘˜:** ____________________
